<!doctype html>
<html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Document Uploads</title>
<link rel="stylesheet" href="/static/css/kb.css">
</head><body>
<header><a href="/">Logout</a> | <a href="/static/users.html">Users</a> | <a href="/static/kb.html">KB</a> | <a href="/static/faq.html">FAQ</a> | <a href="/static/custom.html">Custom Replies</a> | <a href="/static/knowledge.html">Documents</a> | <a href="/static/announcements.html">Notices</a> | <a href="/static/control.html">Control</a> | <a href="/static/sessions.html">Sessions</a> | <a href="/static/analytics.html">Analytics</a> | <a href="/static/audit.html">Audit</a> | <a href="/static/settings.html">Settings</a></header>
<main>
  <h2>Document Uploads</h2>
  <p class="muted">Files are stored under uploads (max 500 MB). Use this for supporting docs.</p>
  <form id="upload-form" enctype="multipart/form-data">
    <input name="title" placeholder="Title" required>
    <input name="department" placeholder="Department">
    <input name="tags" placeholder="Tags (comma)">
    <input type="file" name="file" required>
    <button>Upload</button>
  </form>
  <table id="doc-table"><thead><tr><th>Title</th><th>Department</th><th>Tags</th><th>File</th><th>Actions</th></tr></thead><tbody></tbody></table>
</main>
<script src="/static/js/api.js"></script>
<script>
(async()=>{try{await api('/me')}catch(e){location.href='/'};const form=document.getElementById('upload-form');const table=document.querySelector('#doc-table tbody');const load=async()=>{const rows=await api('/documents');table.innerHTML='';if(!rows.length){table.innerHTML='<tr><td colspan="5">No documents yet</td></tr>';return;}rows.forEach(r=>{const tr=document.createElement('tr');const link=r.download_url?`<a href="${r.download_url}">${r.filename||'download'}</a>`:'-';tr.innerHTML=`<td>${r.title||''}</td><td>${r.department||''}</td><td>${r.tags||''}</td><td>${link}</td><td><button data-id="${r.id}" class="delete">Delete</button></td>`;table.appendChild(tr);});table.querySelectorAll('.delete').forEach(btn=>btn.addEventListener('click',async()=>{if(!confirm('Delete document?'))return;await api('/documents/'+btn.dataset.id,'DELETE');load();}));};load();form.addEventListener('submit',async(e)=>{e.preventDefault();const fd=new FormData(form);const res=await fetch('/api/documents',{method:'POST',body:fd});if(res.ok){form.reset();load();}else{alert('upload failed');}});})();
</script>
</body></html>